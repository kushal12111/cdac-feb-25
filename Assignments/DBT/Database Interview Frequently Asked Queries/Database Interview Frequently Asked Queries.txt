1.
SELECT DISTINCT SAL
FROM EMP E1
WHERE 5 = (
  SELECT COUNT(DISTINCT SAL)
  FROM EMP E2
  WHERE E2.SAL > E1.SAL
);


2.
SELECT 
  MAX(SAL) AS FIRST,
  (SELECT MAX(SAL) FROM EMP WHERE SAL < (SELECT MAX(SAL) FROM EMP)) AS SECOND
FROM EMP;


3.
WITH CTE AS (
  SELECT EMPNO, ROW_NUMBER() OVER (PARTITION BY EMPNO ORDER BY EMPNO) AS RN
  FROM EMP
)
DELETE FROM EMP
WHERE EMPNO IN (
  SELECT EMPNO
  FROM CTE
  WHERE RN > 1
);


4.
WITH AllNumbers AS (
  SELECT LEVEL AS NUM
  FROM DUAL
  CONNECT BY LEVEL <= (SELECT MAX(EMPNO) FROM EMP)
),
MissingRanges AS (
  SELECT 
    MIN(NUM) AS StartRange,
    MAX(NUM) AS EndRange
  FROM (
    SELECT 
      NUM,
      NUM - ROW_NUMBER() OVER (ORDER BY NUM) AS Grp
    FROM AllNumbers
    WHERE NUM NOT IN (SELECT EMPNO FROM EMP)
  )
  GROUP BY Grp
)
SELECT StartRange || ' â€“ ' || EndRange AS MISSING
FROM MissingRanges
ORDER BY StartRange;




5.
SELECT 
  SUM(DEPO - WITHD) OVER (ORDER BY ROWID) AS Balance
FROM BANK;


6.
SELECT 
  EMPNO,
  FLOOR(MONTHS_BETWEEN(SYSDATE, HIREDATE) / 12) AS YEARS,
  MOD(FLOOR(MONTHS_BETWEEN(SYSDATE, HIREDATE)), 12) AS MONTHS,
  TRUNC(SYSDATE - ADD_MONTHS(HIREDATE, FLOOR(MONTHS_BETWEEN(SYSDATE, HIREDATE)))) AS DAYS
FROM EMP;


7.
CREATE OR REPLACE FUNCTION NumToWords (num IN NUMBER)
RETURN VARCHAR2 IS
  words VARCHAR2(4000);
BEGIN
 

  words := '...'; -- Replace with proper conversion logic
  RETURN words;
END;
/

SELECT SAL, NumToWords(SAL) AS SalaryInWords
FROM EMP
WHERE SAL <= 5000000;